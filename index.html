<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profesyonel To-Do List</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Ãœst MenÃ¼ -->
  <header class="navbar">
    <nav>
      <ul>
        <li><button class="nav-btn active" data-section="home">Ana Sayfa</button></li>
        <li><button class="nav-btn" data-section="tasks">GÃ¶revler</button></li>
        <li><button class="nav-btn" data-section="profile">Profil</button></li>
      </ul>
    </nav>
  </header>

  <!-- Ana iÃ§erik alanÄ± -->
  <main class="app-container">
    <!-- Ana Sayfa -->
    <section id="home" class="section">
      <h1>HoÅŸgeldin!</h1>
      <p>Burada kendi yapÄ±lacaklar listeni yÃ¶netebilir, profil oluÅŸturabilirsin.</p>
      <p>MenÃ¼den GÃ¶revler ve Profil kÄ±sÄ±mlarÄ±na geÃ§iÅŸ yapabilirsin.</p>
    </section>

    <!-- GÃ¶revler -->
    <section id="tasks" class="section hidden">
      <div class="todo-header">
        <h2>GÃ¶revlerin</h2>
        <div class="header-actions">
          <button id="toggleThemeBtn" title="TemayÄ± deÄŸiÅŸtir">ğŸŒ—</button>
          <button id="logoutBtn" title="Ã‡Ä±kÄ±ÅŸ yap">Ã‡Ä±kÄ±ÅŸ</button>
        </div>
      </div>

      <form id="taskForm">
        <input
          type="text"
          id="taskInput"
          placeholder="Yeni gÃ¶rev girin..."
          autocomplete="off"
          required
        />
        <input type="date" id="dueDateInput" />
        <button type="submit">Ekle</button>
      </form>

      <ul id="taskList" aria-live="polite" aria-label="GÃ¶rev Listesi"></ul>
    </section>

    <!-- Profil -->
    <section id="profile" class="section hidden">
      <h2>Profil AyarlarÄ±</h2>
      <label for="profileUsername">KullanÄ±cÄ± AdÄ±</label>
      <input
        type="text"
        id="profileUsername"
        placeholder="KullanÄ±cÄ± adÄ±nÄ±zÄ± girin"
        autocomplete="off"
        required
      />
      <button id="saveProfileBtn">Kaydet</button>
    </section>
  </main>

  <script>
    // MenÃ¼ butonlarÄ± ve bÃ¶lÃ¼mler
    const navButtons = document.querySelectorAll(".nav-btn");
    const sections = document.querySelectorAll(".section");

    navButtons.forEach((btn) =>
      btn.addEventListener("click", () => {
        navButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");

        const target = btn.dataset.section;
        sections.forEach((sec) => {
          sec.classList.toggle("hidden", sec.id !== target);
        });
      })
    );

    // TemayÄ± deÄŸiÅŸtir (Koyu - AÃ§Ä±k)
    const toggleThemeBtn = document.getElementById("toggleThemeBtn");
    toggleThemeBtn?.addEventListener("click", () => {
      document.body.classList.toggle("dark");
    });

    // Basit kullanÄ±cÄ± ve gÃ¶rev yÃ¶netimi
    let currentUser = localStorage.getItem("todo_user") || "";
    if (!currentUser) {
      currentUser = prompt("LÃ¼tfen kullanÄ±cÄ± adÄ±nÄ±zÄ± girin") || "Misafir";
      localStorage.setItem("todo_user", currentUser);
    }

    const profileUsernameInput = document.getElementById("profileUsername");
    const saveProfileBtn = document.getElementById("saveProfileBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const taskForm = document.getElementById("taskForm");
    const taskInput = document.getElementById("taskInput");
    const dueDateInput = document.getElementById("dueDateInput");
    const taskList = document.getElementById("taskList");

    // Profil kullanÄ±cÄ± adÄ±nÄ± yÃ¼kle
    profileUsernameInput.value = currentUser;

    // GÃ¶revleri yÃ¼kle
    function loadTasks() {
      const tasks = JSON.parse(localStorage.getItem("todo_tasks")) || [];
      taskList.innerHTML = "";

      const userTasks = tasks.filter((t) => t.user === currentUser);
      if (userTasks.length === 0) {
        const noTask = document.createElement("li");
        noTask.textContent = "GÃ¶rev eklenmedi.";
        noTask.style.fontStyle = "italic";
        noTask.style.color = "#777";
        taskList.appendChild(noTask);
        return;
      }

      userTasks.forEach((task) => {
        const li = document.createElement("li");

        const textSpan = document.createElement("span");
        textSpan.classList.add("task-text");
        textSpan.textContent = task.text;
        if (task.completed) textSpan.classList.add("task-completed");

        // TamamlandÄ± toggle
        textSpan.addEventListener("click", () => toggleComplete(task.id));

        li.appendChild(textSpan);

        if (task.dueDate) {
          const dateSpan = document.createElement("span");
          dateSpan.classList.add("task-date");
          dateSpan.textContent = formatDate(task.dueDate);

          // Tarih tÄ±klayÄ±nca da tamamlandÄ± toggle
          dateSpan.addEventListener("click", () => toggleComplete(task.id));

          li.appendChild(dateSpan);
        }

        const deleteBtn = document.createElement("button");
        deleteBtn.classList.add("delete-btn");
        deleteBtn.textContent = "Sil";
        deleteBtn.title = "GÃ¶revi sil";
        deleteBtn.addEventListener("click", () => deleteTask(task.id));

        li.appendChild(deleteBtn);

        taskList.appendChild(li);
      });
    }

    // Tarih formatlama (gg.aa.yyyy)
    function formatDate(dateStr) {
      const [year, month, day] = dateStr.split("-");
      return `${day}.${month}.${year}`;
    }

    // GÃ¶rev tamamlandÄ± toggle
    function toggleComplete(id) {
      let tasks = JSON.parse(localStorage.getItem("todo_tasks")) || [];
      tasks = tasks.map((task) => {
        if (task.id === id) {
          task.completed = !task.completed;
        }
        return task;
      });
      localStorage.setItem("todo_tasks", JSON.stringify(tasks));
      loadTasks();
    }

    // GÃ¶rev sil
    function deleteTask(id) {
      let tasks = JSON.parse(localStorage.getItem("todo_tasks")) || [];
      tasks = tasks.filter((task) => task.id !== id);
      localStorage.setItem("todo_tasks", JSON.stringify(tasks));
      loadTasks();
    }

    // Yeni gÃ¶rev ekle
    taskForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const text = taskInput.value.trim();
      if (!text) return alert("GÃ¶rev boÅŸ olamaz!");
      const dueDate = dueDateInput.value;

      const tasks = JSON.parse(localStorage.getItem("todo_tasks")) || [];
      const newTask = {
        id: Date.now().toString(),
        text,
        dueDate,
        completed: false,
        user: currentUser,
      };
      tasks.push(newTask);
      localStorage.setItem("todo_tasks", JSON.stringify(tasks));
      taskInput.value = "";
      dueDateInput.value = "";
      loadTasks();
    });

    // Profil kaydet
    saveProfileBtn.addEventListener("click", () => {
      const newName = profileUsernameInput.value.trim();
      if (!newName) return alert("KullanÄ±cÄ± adÄ± boÅŸ olamaz!");
      changeUsername(newName);
      alert("Profil gÃ¼ncellendi!");
    });

    // KullanÄ±cÄ± adÄ±nÄ± deÄŸiÅŸtir
    function changeUsername(newName) {
      const tasks = JSON.parse(localStorage.getItem("todo_tasks")) || [];
      tasks.forEach((task) => {
        if (task.user === currentUser) {
          task.user = newName;
        }
      });
      localStorage.setItem("todo_tasks", JSON.stringify(tasks));
      currentUser = newName;
      localStorage.setItem("todo_user", currentUser);
      profileUsernameInput.value = currentUser;
      loadTasks();
    }

    // Ã‡Ä±kÄ±ÅŸ yap
    logoutBtn.addEventListener("click", () => {
      localStorage.removeItem("todo_user");
      location.reload();
    });

    // BaÅŸlangÄ±Ã§ta gÃ¶revleri yÃ¼kle
    loadTasks();
  </script>
</body>
</html>
